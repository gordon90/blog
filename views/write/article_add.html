<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>添加-修改</title>
    <link rel="stylesheet" href="/static/write/frame/layui/css/layui.css">
    <link rel="stylesheet" href="/static/write/frame/static/css/style.css">
    <link rel="icon" href="/static/write/frame/static/image/code.png">

    {{/* 编辑器 css*/}}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/write/froala/css/froala_editor.css">
    <link rel="stylesheet" href="/static/write/froala/css/froala_style.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/code_view.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/draggable.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/colors.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/emoticons.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/image_manager.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/image.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/line_breaker.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/table.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/char_counter.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/video.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/fullscreen.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/file.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/quick_insert.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/help.css">
    <link rel="stylesheet" href="/static/write/froala/css/third_party/spell_checker.css">
    <link rel="stylesheet" href="/static/write/froala/css/plugins/special_characters.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.3.0/codemirror.min.css">
</head>
<body class="body">

<div id="editor">
<form class="layui-form layui-form-pane">
    <div class="layui-form-item">
        <label class="layui-form-label">单行选择框</label>

        <div class="layui-input-block">
            <select id="cate_id" name="interest" lay-filter="aihao">
                <option value="">请选择</option>
                {{range .cate}}
                    <option value="{{.id}}">{{.name}}</option>
                {{end}}

            </select>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">标题</label>
        <div class="layui-input-block">
            <input type="text" id="title" name="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item layui-form-text">
        <div class="layui-input-block">
            <textarea id="edit" placeholder="请输入内容" class="layui-textarea"></textarea>
        </div>
        <label class="layui-form-label">请输入内容</label>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">作者</label>
        <div class="layui-input-inline">
            <input type="text" id="author" name="username"  placeholder="请输入" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">来源</label>
        <div class="layui-input-block">
            <input type="text" name="title" id="source" autocomplete="off" placeholder="请输入标题" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <input  class="layui-btn" lay-submit="" lay-filter="sub" type="submit">
        {{/*<button>提交</button>*/}}
    </div>
</form>
</div>

<script src="/static/write/frame/layui/layui.js" charset="utf-8"></script>

{{/* 编辑器 js*/}}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.3.0/codemirror.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.3.0/mode/xml/xml.min.js"></script>

<script type="text/javascript" src="/static/write/froala/js/froala_editor.min.js" ></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/align.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/char_counter.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/code_beautifier.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/code_view.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/colors.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/draggable.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/emoticons.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/entities.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/file.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/font_size.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/font_family.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/fullscreen.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/image.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/image_manager.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/line_breaker.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/inline_style.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/link.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/lists.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/paragraph_format.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/paragraph_style.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/quick_insert.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/quote.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/table.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/save.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/url.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/video.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/help.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/print.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/third_party/spell_checker.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/special_characters.min.js"></script>
<script type="text/javascript" src="/static/write/froala/js/plugins/word_paste.min.js"></script>

<script type="text/javascript">

    layui.use(['form', 'layedit', 'laydate', 'element'], function () {
        var form = layui.form
                , layer = layui.layer
                , layedit = layui.layedit
                , laydate = layui.laydate
                , element = layui.element;
    });

    $(function(){
        //超大屏幕
        var toolbarButtons   = ['fullscreen', 'bold', 'italic', 'underline', 'strikeThrough', 'subscript', 'superscript', 'fontFamily', 'fontSize', '|', 'color', 'emoticons', 'inlineStyle', 'paragraphStyle', '|', 'paragraphFormat', 'align', 'formatOL', 'formatUL', 'outdent', 'indent', 'quote', 'insertHR', '-', 'insertLink', 'insertImage', 'insertVideo', 'insertFile', 'insertTable', 'undo', 'redo', 'clearFormatting', 'selectAll', 'html'];
        //大屏幕
        var toolbarButtonsMD = ['fullscreen', 'bold', 'italic', 'underline', 'fontFamily', 'fontSize', 'color', 'paragraphStyle', 'paragraphFormat', 'align', 'formatOL', 'formatUL', 'outdent', 'indent', 'quote', 'insertHR', 'insertLink', 'insertImage', 'insertVideo', 'insertFile', 'insertTable', 'undo', 'redo', 'clearFormatting'];
        //小屏幕
        var toolbarButtonsSM = ['fullscreen', 'bold', 'italic', 'underline', 'fontFamily', 'fontSize', 'insertLink', 'insertImage', 'insertTable', 'undo', 'redo'];
        //手机
        var toolbarButtonsXS = ['bold', 'italic', 'fontFamily', 'fontSize', 'undo', 'redo'];

        $('#edit')
            .on('froalaEditor.initialized', function (e, editor) {
                $('#edit').parents('form').on('submit', function () {
                    $.ajax({
                        url:"article_post",
                        type:"post",
                        async:false,
                        data:{
                            Cate_id:$('#cate_id').val(),
                            Title:$('#title').val(),
                            Content:$('#edit').val(),
                            Author:$('#author').val(),
                        },
                        success:function (data) {
                            console.log(data);
                            switch (data.code) {
                                case 200:
                                    window.location.href = "article_list";
                                    break;
                                case 201:
                                    alert("Err");
                                    break;
                            }
                        },
                        error: function (data) {
                        }
                    });
                    return false;
                })
            })
            // .froalaEditor({enter: $.FroalaEditor.ENTER_P, placeholderText: null})
            .froalaEditor({
                //编辑器初始化并赋值
                placeholderText: '请输入内容',
                charCounterCount       : true,//默认
                // charCounterMax         : -1,//默认
                saveInterval            : 0,//不自动保存，默认10000
                // theme                    : "red",
                height                   : "300px",
                toolbarBottom           : false,//默认
                toolbarButtonsMD        : toolbarButtonsMD,
                toolbarButtonsSM        : toolbarButtonsSM,
                toolbarButtonsXS        : toolbarButtonsXS,
                toolbarInline           : false,//true选中设置样式,默认false
                imageUploadMethod       : 'POST',
                heightMin: 450,
                charCounterMax: 3000,
                // imageUploadURL: "uploadImgEditor",
                imageParams: { postId: "123" },
                params: {
                    acl: '01',
                    AWSAccessKeyId: '02',
                    policy: '03',
                    signature: '04',
                },
                autosave: true,
                autosaveInterval: 2500,
                saveURL: 'hander/FroalaHandler.ashx',
                saveParams: { postId: '1'},
                spellcheck: false,
                imageUploadURL: '/uploadimg',//上传到本地服务器
                {{/*imageUploadParams: {pid: '{{.Id}}'},*/}}
                imageDeleteURL: 'lib/delete_image.php',//删除图片
                imagesLoadURL: 'lib/load_images.php',//管理图片
                enter: $.FroalaEditor.ENTER_BR,
                language: 'zh_cn',
                // toolbarButtons: ['bold', 'italic', 'underline', 'paragraphFormat', 'align','color','fontSize','insertImage','insertTable','undo', 'redo']
            })
    });

</script>
</body>
</html>